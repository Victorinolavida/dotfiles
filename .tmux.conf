# set -ga terminal-overrides ',xterm-kitty:RGB'
# set -g default-terminal "xterm-kitty"
# set-option -sa terminal-overrides ",xterm*:Tc"

# Habilitar mouse
set -g mouse on

# Prefijo personalizado
set -g prefix C-x
unbind C-b
bind C-x send-prefix

# Estilo Vim para moverse entre paneles
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Redimensionar usando Alt + flechas
bind -n M-Up resize-pane -U 5
bind -n M-Down resize-pane -D 5
bind -n M-Left resize-pane -L 5
bind -n M-Right resize-pane -R 5

# Cambiar de ventana con Alt + n√∫mero
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9

# Floating window con Alt + g
bind-key -n M-g if-shell -F '#{==:#{session_name},scratch}' \
  "detach-client" \
  "display-popup -E 'tmux new-session -A -s scratch'"

# Tema Kanagawa
set -g @plugin 'Nybkox/tmux-kanagawa'
set -g @kanagawa-theme "dragon"

# Plugins disponibles: battery, cpu-usage, git, gpu-usage, ram-usage, tmux-ram-usage, network, network-bandwidth, network-ping, ssh-session, attached-clients, network-vpn, weather, time, mpc, spotify-tui, playerctl, kubernetes-context, synchronize-panes
set -g @kanagawa-plugins "cpu-usage ram-usage time"
# set -g @dracula-show-right-sep
set -g @kanagawa-show-powerline true
set -g @kanagawa-show-timezone false

# Fondo transparente
set -g @kanagawa-ignore-window-colors true

# Plugins TPM
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'jaclu/tmux-menus'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# Terminal y colores
set-option -ga terminal-overrides ",xterm*:Tc"
set -g default-terminal "tmux-256color"
set-option -ga terminal-overrides ",tmux-256color:Tc"

# Highlight del prefijo y fecha/hora
set -g status-right '#{prefix_highlight} | %a %Y-%m-%d %H:%M'

set -g @catppuccin_directory_text "#{b:pane_current_path}"

set -g @catppuccin_date_time_text "%H:%M"

set -g @catppuccin_window_status_style "rounded" # can comment this out

set -g status-position top

# tmux-nofity
# https://github.com/rickstaa/tmux-notify
# prefix + m: Start monitoring a pane and notify when it finishes.
# prefix + alt + m: Start monitoring a pane, return it in focus and notify when it finishes.
# prefix + M: Cancel monitoring of a pane.
set -g @plugin 'rickstaa/tmux-notify'

# nerd font
set -g @plugin 'joshmedeski/tmux-nerd-font-window-name'

# tmux-menus
set -g @plugin 'jaclu/tmux-menus'
# trigger
set -g @menus_trigger 'Space'

#lazygit
set -g @plugin 'AngryMorrocoy/tmux-neolazygit'
set -g @open-lazygit 'g'


# loggin
# https://github.com/tmux-plugins/tmux-logging
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @logging-path 'logs'

# pomodoro
set -g @plugin 'olimorris/tmux-pomodoro-plus'

# <tmux-prefix> p to toggle between starting/pausing a Pomodoro/break
# <tmux-prefix> P to cancel a Pomodoro/break
# <tmux-prefix> _ to skip a Pomodoro/break
# <tmux-prefix> e to restart a Pomodoro
# <tmux-prefix> C-p to open the Pomodoro timer menu
# <tmux-prefix> M-p to set a custom Pomodoro timer


# tmux-newsboat?
set -g @plugin 'tmux-plugins/tmux-newsboat'

# tmux pane focus
set -g @plugin 'graemedavidson/tmux-pane-focus'
# set -g @plugin 'graemedavidson/tmux-pane-focus#tag'
set -g @pane-focus-enabled on
set -g @pane-focus-size '50'
set -g @pane-focus-direction '+'


set -g automatic-rename-format "#{window_icon} #{b:pane_current_path}"

bind '%' split-window -h -c "#{pane_current_path}"
bind '"' split-window -v -c "#{pane_current_path}"

# Configuraciones adicionales
set -sg escape-time 0
set -g status-interval 5
set -g status-position top
set -g mode-keys vi

# Copiar con pbcopy o clip dependiendo del SO
if-shell 'uname | grep -q Darwin' \
  'bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"' \
  'bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "clip"'

bind-key -r f run-shell "tmux neww ~/.config/tmux/scripts/tmux-sessionizer"

bind -n C-r display-popup \
  -d "#{pane_current_path}" \
  -w 90% \
  -h 90% \
  -E "ranger"

bind -n C-t display-popup \
  -d "#{pane_current_path}" \
  -w 75% \
  -h 75% \
  -E "zsh"

# Ejecutar TPM
run '~/.tmux/plugins/tpm/tpm'


